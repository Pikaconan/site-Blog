---
layout: post
title: 博客迁移二三事
slug: something-about-blog-migration
date: 2019/12/21 19:55:00
status: publish
author: 原谅糖
tags: 
excerpt: 从虚拟主机换到阿里云轻量学生机。
---


我还是放弃了虚拟主机，从那天客服给我解决 BUG 时，直接在我的目录里添加修改文件，我就有点害怕，我早就该明白的。

### 服务器

本来我买了 [阿里云](https://www.aliyun.com/minisite/goods?userCode=qd1f2gzc&share_source=copy_link) 双十一的 T5，但是后来想想 20% 性能基线，1M 带宽还是太弱了。于是发工单退掉，转而选择了轻量学生机，有 5M 的带宽，CPU 性能 100%，114 一年感觉也很实惠。

### 域名转入

使用国内服务器需要域名备案，我需要把域名转入到阿里云。阿里云 xyz 域名续费一年只要 39，这是我没想到的，我在阿里和腾讯查询 xyz 续费价格都是 70 左右。

提交域名转入之后，需要等待 5 天才能完成转入。在这中间我还经历了实名认证无法通过的窘境，我拍了十几次身份证照片，反复确认信息填写正确，却始终无法通过实名认证。后来提交工单，客服一顿远程操作也无法解决，最终联系了实名局紧急处理后，我才完成实名认证。

转入成功后，不能立即备案，需要等两天实名认证信息同步。

### 备案

现在备案不需要幕布了，阿里云使用 APP，腾讯云使用小程序，都可以直接摄像头验证身份。

备案时网站名称可以随意填，如果不对，客服会打电话通知你修改，无需纠结。我所在的江苏对网站名称的要求比较特殊，必须是 XX 的个人博客，XX 是真名......

提交后初审很快，10 分钟内就会有客服联系我修改 XX 的个人博客......之后提交管局，页面显示需要等 12 天，我实际等待了 11 天左右。

### 宝塔

轻量服务器预装的是宝塔 5.2，过于旧，而且在宝塔里无法直接升级到 6.x，可以在轻量服务器面板里直接重置成 6.8 版本，再升级到最新版。

防火墙默认只放行了80 443 22，需要手动添加 8888 用于宝塔访问，建议之后修改这个默认端口。

备案时，服务器的 80 端口是封锁的，可以在宝塔中添加网站，域名栏直接填写服务器 IP，通过 IP 访问来调试网站。

上传博客文件的时候，才发现 FTP 有多难用，最后拥抱了 SFTP，Xshell+Xftp 可太好用了。

### 搭建

除了迁移我的博客，我还使用 docker 搭建了 RSSHub，即使面对微博这样反爬严格的网站，也能稳定订阅 RSS 了。

图床是我心心念念了好久的工具，现在终于可以自建了。之前一直使用的群友的图床，速度非常快，但是图片放在别人那里还是不太好，我也不太喜欢那个图床程序的使用逻辑。于是我使用 Lsky 搭建了我自己的图床，使用又拍云对象存储作为图片的家。

[又拍云](https://console.upyun.com/register/?invite=SycyPYiRB) 可以申请免费的对象存储空间和 CDN 加速，支持 Gzip 和 Brotli 压缩，还能自适应加载 webp。另外，我还使用了宝塔的计划任务定期将网站和数据库备份到又拍云对象存储。

### 后记

从虚拟主机到阿里学生机，感觉鸟枪换大炮了，能做的事多了许多，这样看来其实虚拟主机性价比太低了。